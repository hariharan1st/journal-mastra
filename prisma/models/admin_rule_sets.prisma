enum RuleSetStatus {
  draft
  published
  superseded
}

model AdminRuleSet {
  id                String        @id @default(uuid()) @db.Uuid
  version           Int           @default(autoincrement())
  publishedAt       DateTime      @map("published_at") @db.Timestamptz
  publishedBy       String?       @map("published_by") @db.Uuid
  sourceText        String        @map("source_text") @db.Text
  structuredConfig  Json          @map("structured_config") @db.JsonB
  status            RuleSetStatus @default(draft)
  checksum          String        @db.Text

  publishedByCaregiverProfile CaregiverProfile?          @relation(fields: [publishedBy], references: [id])
  trackingCatalogueItems      TrackingCatalogueItem[]
  auditEvents                 AuditEvent[]

  @@unique([version])
  @@index([status, publishedAt(sort: Desc)])
  @@map("admin_rule_sets")
}